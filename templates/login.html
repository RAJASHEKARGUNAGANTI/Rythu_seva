<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="Free Web tutorials" />
    <meta name="keywords" content="HTML, CSS, JavaScript" />
    <meta name="author" content="John Doe" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fuzzy+Bubbles&display=swap"
      rel="stylesheet"
    />
    <title>Login</title>
    <!-- <link rel="stylesheet" href="styles.css"> -->
    <style>
      /* styles.css */
      body {
        background-image: url("../static/images/background.jpg");
        background-repeat: no-repeat;
        background-size: cover;
      }

      .container {
        max-width: 400px;
        margin: 50px auto;
        padding: 20px;
        border: 1px solid #ccc;
        border-radius: 5px;
        background-color: #f9f9f9;
      }

      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        margin-bottom: 5px;
      }

      input[type="text"],
      input[type="email"],
      input[type="password"] {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;
      }

      button {
        padding: 10px 20px;
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }

      button:hover {
        background-color: #0056b3;
      }

      p {
        margin-top: 15px;
        text-align: center;
      }

      p a {
        color: #007bff;
        text-decoration: none;
      }

      p a:hover {
        text-decoration: underline;
      }

      #navi a:hover {
        color: rgb(252, 251, 251);
        background-color: rgb(1, 98, 1);
      }

      #navi a:active {
        color: rgb(255, 255, 255);
        background-color: rgb(1, 91, 1);
      }

      #navi {
        background-image: linear-gradient(
          to bottom right,
          rgb(44, 173, 61),
          rgb(38, 42, 1)
        );
      }

      #navi a {
        padding-top: 10px;
        position: relative;
      }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-success" id="navi">
      <div class="container-fluid">
        <a
          class="navbar-brand"
          href="#"
          style="font-size: 35px; padding-left: 10px"
        >
          <img
            src="../static/images/farmer-logo.png"
            alt="logo"
            srcset
            width="60px"
          />
          <b style="padding-left: 15px; font-family: 'Handlee', cursive"
            >Rythu Seva</b
          ></a
        >
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link" aria-current="page" href="/home">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/crop">Crop Suggestion</a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="https://karthik6717-tomato-disease-main-8jasm5.streamlit.app/"
                >Crop Disease Prediction</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/fertilizer"
                >Fertilizers Recomendation</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/techFarming">Tech Farming</a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Ecommerce
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="/seeds">Seeds</a></li>
                <li>
                  <hr class="dropdown-divider" />
                </li>
                <li>
                  <a class="dropdown-item" href="/fertilizers">Fertilizers</a>
                </li>
                <li>
                  <hr class="dropdown-divider" />
                </li>
                <li>
                  <a class="dropdown-item" href="/pesticides">Pesticides</a>
                </li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link active dropdown-toggle"
                href="#"
                id="navbarDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Services
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="/login">Login</a></li>
                <li>
                  <hr class="dropdown-divider" />
                </li>
                <li><a class="dropdown-item" href="/register">Register</a></li>
                <li>
                  <hr class="dropdown-divider" />
                </li>
                <li>
                  <li><a class="dropdown-item" id="logoutBtn">Logout</a></li>
                </li>
              </ul>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" tabindex="-1">
                <div
                  id="google_translate_element"
                  style="border-radius: 5px; padding-left: 50px"
                ></div>
              </a>
            </li>
          </ul>
          <!-- <form class="d-flex">
            <input
              class="form-control me-2"
              type="search"
              placeholder="Search"
              aria-label="Search"
            />
            <button class="btn btn-primary btn-outline-light" type="submit">
              Search
            </button>
          </form> -->
        </div>
      </div>
    </nav>
    <div class="container">
      <form id="loginForm">
        <h2>Login</h2>
        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
        </div>
        <div class="form-group">
            <label for="password">Password:</label>
            <input type="password" id="password" name="password" required>
        </div>
        <button type="submit">Login</button>
    </form>
   
      <p>Don't have an account? <a href="/register">Register</a></p>
    </div>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
    const loginForm = document.getElementById('loginForm');
    const errorMessage = document.getElementById('errorMessage');

    loginForm.addEventListener('submit', function (event) {
        event.preventDefault();

        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        // Make a POST request to the backend
        fetch('http://localhost:3000/signin', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ email, password })
        })
        .then(response => {
            if (response.ok) {
                // Redirect to home page or perform other actions
                alert("Login successful");
                window.location.href = 'http://127.0.0.1:5000/home';
            } else {
                return response.json(); // Parse response body as JSON
            }
        })
        .then(data => {
            if (data && data.error) {
                errorMessage.textContent = data.error;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            errorMessage.textContent = 'An error occurred. Please try again later.';
        });
    });
});

    </script>

<script>
  document.getElementById('logoutBtn').addEventListener('click', async function() {
      try {
          const response = await fetch('http://localhost:3000/logout', {
              method: 'POST',
              credentials: 'include' // Include cookies in the request
          });

          if (response.ok) {
              const responseData = await response.json();
              alert(responseData.message);
              window.location.href = '/login'; // Redirect to login page after logout
          } else {
              const errorMessage = await response.text();
              alert(errorMessage);
          }
      } catch (error) {
          console.error('Error:', error);
          alert('An error occurred. Please try again later.');
      }
  });
</script>
  </body>
</html>
